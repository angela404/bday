<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Photobooth Strip</title>
<style>
body {
  margin:0; padding:0;
  display:flex; justify-content:center; align-items:center;
  height:100vh; background:#ffd7e9;
  font-family: 'Poppins', sans-serif;
}
#cameraContainer {
  position:relative; width:400px; height:300px;
  border-radius:20px; overflow:hidden; background:#000;
}
video {
  width:100%; height:100%; object-fit:cover;
  display:block;
}
#cameraFrame {
  position:absolute; top:0; left:0; width:100%; height:100%;
  border: 10px solid rgba(255,255,255,0.8);
  border-radius:20px; pointer-events:none;
  box-sizing:border-box;
}
#countdown {
  position:absolute; top:50%; left:50%;
  transform: translate(-50%, -50%);
  font-size:60px; color:white; font-weight:bold;
  text-shadow: 2px 2px 10px rgba(0,0,0,0.7);
  display:none;
}
#shootBtn { margin-top:10px; padding:10px 20px; font-size:16px; cursor:pointer; }
#stripContainer {
  margin-top:20px; display:flex; justify-content:center;
}
.stripPreview {
  border:5px solid white; border-radius:10px;
  box-shadow:0 4px 20px rgba(0,0,0,0.4);
  display:flex; flex-direction:column; gap:5px;
}
.stripPreview img {
  width:120px; border-radius:5px; display:block;
}
</style>
</head>
<body>

<div>
  <div id="cameraContainer">
    <video id="video" autoplay></video>
    <div id="cameraFrame"></div>
    <div id="countdown"></div>
  </div>
  <button id="shootBtn">Ambil Strip Foto</button>
  <div id="stripContainer"></div>
</div>

<script>
const video = document.getElementById('video');
const countdownEl = document.getElementById('countdown');
const stripContainer = document.getElementById('stripContainer');
const shootBtn = document.getElementById('shootBtn');

// akses kamera
navigator.mediaDevices.getUserMedia({ video: true })
.then(stream => { video.srcObject = stream; })
.catch(err => { alert('Akses kamera ditolak'); console.error(err); });

shootBtn.addEventListener('click', () => {
  const maxShots = 3;
  let shotsTaken = 0;
  const photos = []; // menyimpan dataURL sementara

  function takeShot() {
    if(shotsTaken >= maxShots) return;
    let count = 3;
    countdownEl.style.display = 'block';
    countdownEl.textContent = count;

    const interval = setInterval(() => {
      count--;
      if(count>0) countdownEl.textContent = count;
      else {
        clearInterval(interval);
        countdownEl.style.display = 'none';

        // ambil snapshot dari video
        const canvas = document.createElement('canvas');
        canvas.width = video.videoWidth;
        canvas.height = video.videoHeight;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

        photos.push(canvas.toDataURL('image/png')); // simpan dulu, jangan tampil

        shotsTaken++;
        if(shotsTaken < maxShots) {
          setTimeout(takeShot, 1000); // delay antar foto
        } else {
          showStripPreview(photos); // setelah 3 foto, tampilkan strip
        }
      }
    }, 1000);
  }

  takeShot();
});

function showStripPreview(photos) {
  stripContainer.innerHTML = ''; // clear sebelumnya
  const strip = document.createElement('div');
  strip.className = 'stripPreview';
  photos.forEach(url => {
    const img = document.createElement('img');
    img.src = url;
    strip.appendChild(img);
  });
  stripContainer.appendChild(strip);
}
</script>
</body>
</html>
